<html>

<head>
    <title>RPG</title>
</head>

<body>
    <canvas id="canvas"></canvas>
    <script type="text/javascript" src="src/point.js"></script>
    <script type="text/javascript" src="src/graphics.js"></script>
    <script type="text/javascript" src="src/player.js"></script>
    <script type="text/javascript" src="src/map.js"></script>
    <script type="text/javascript" src="src/render.js"></script>
    <script type="text/javascript">
        var canvas = document.getElementById("canvas");
        canvas.width = 800;
        canvas.height = 600;
        canvas.style.width = canvas.width;
        canvas.style.height = canvas.height;

        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "#eeeeee";
        ctx.fillRect(0, 0, 800, 600);

        var renderSettings = {
            yMin: -6,
            yMax: 1,
            xMin: -3,
            xMax: 5,
            cellSize: 100,
            cellHeight: 80,
            playerHeight: 50,
            windowWidth: 800,
            windowHeight: 400,
            distance: 700,
            renderCellDistance: 6,
            renderCellWidth: 2
        };
        var player = new Player();
        var map = new Map();
        map.tiles = [
            [0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 2, 2, 2, 2, 2, 2, 2, 0],
            [0, 2, 0, 0, 2, 0, 0, 2, 0],
            [0, 2, 2, 2, 2, 0, 0, 2, 0],
            [0, 2, 0, 2, 2, 0, 0, 2, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0],
        ];
        /*
        map.tiles = [
            [0, 0, 0, 0],
            [0, 2, 2, 0],
            [0, 2, 2, 0],
            [0, 0, 0, 0]
        ];
        */
        var render = new Render(renderSettings, map, player);
        render.render();

        document.addEventListener('keydown', (event) => {
            const keyName = event.key;
            switch(keyName) {
                case "ArrowUp": 
                    player.moveForward(map);
                    break;
                case "ArrowDown": 
                    player.moveBackward(map);
                    break;
                case "ArrowLeft": 
                    player.turnLeft();
                    break;
                case "ArrowRight": 
                    player.turnRight();
                    break;
            }

            ctx.fillStyle = "#eeeeee";
            ctx.fillRect(0, 0, 800, 600);
            render.render();
        });

        console.log(render);
        console.log(map);
        console.log(player);
    </script>
</body>

</html>